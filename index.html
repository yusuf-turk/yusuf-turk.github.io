<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Denizli TamgalarÄ± - Ä°nteraktif Atlas</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        /* --- GENEL TASARIM --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1a1a1a;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        header {
            background-color: #111;
            color: #eee;
            text-align: center;
            padding: 15px;
            flex-shrink: 0;
            border-bottom: 3px solid #c0392b;
            z-index: 1000;
        }

        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
            position: relative;
        }

        #map {
            flex: 3;
            height: 100%;
            background-color: #1a1a1a;
            z-index: 1;
        }

        #sidebar {
            flex: 1;
            background-color: #222;
            color: #ddd;
            padding: 20px;
            overflow-y: auto;
            box-sizing: border-box;
            border-left: 1px solid #333;
            box-shadow: -5px 0 15px rgba(0,0,0,0.5);
            z-index: 2;
        }
        
        #sidebar-content {
            padding-bottom: 100px;
        }

        /* Scrollbar */
        #sidebar::-webkit-scrollbar { width: 8px; }
        #sidebar::-webkit-scrollbar-track { background: #222; }
        #sidebar::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }
        #sidebar::-webkit-scrollbar-thumb:hover { background: #c0392b; }

        /* --- KART TASARIMI --- */
        .location-header {
            color: #e74c3c;
            border-bottom: 2px solid #444;
            padding-bottom: 10px;
            margin-bottom: 10px;
            font-size: 1.5rem;
        }

        /* YENÄ°: STREET VIEW BUTONU */
        .street-view-btn {
            display: block;
            width: 100%;
            background-color: #2980b9;
            color: white;
            text-align: center;
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: bold;
            transition: background 0.3s;
            box-sizing: border-box;
        }
        .street-view-btn:hover {
            background-color: #3498db;
        }

        .tamga-card {
            background-color: #2a2a2a;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 25px;
            position: relative;
        }

        .tamga-title {
            color: #fff;
            margin-top: 0;
            margin-bottom: 8px;
            font-size: 1.1rem;
            border-left: 3px solid #e74c3c;
            padding-left: 10px;
        }

        .tamga-period {
            display: inline-block;
            background-color: #d35400;
            color: white;
            font-size: 0.8rem;
            font-weight: bold;
            padding: 4px 10px;
            border-radius: 12px;
            margin-bottom: 10px;
        }

        .tamga-img {
            width: 100%;
            height: auto;
            border-radius: 4px;
            margin: 5px 0 10px 0;
            border: 1px solid #555;
        }

        .tamga-desc {
            font-size: 0.9rem;
            line-height: 1.5;
            color: #bbb;
        }

        .map-label {
            background: transparent;
            border: none;
            box-shadow: none;
            color: #fff;
            font-weight: bold;
            font-size: 14px;
            text-shadow: 2px 2px 4px #000;
            margin-top: -10px;
        }

        @media (max-width: 768px) {
            .main-container { flex-direction: column; }
            #map { flex: 1; height: 50vh; }
            #sidebar { flex: 1; height: 50vh; }
        }
    </style>
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>
</head>
<body>

    <header>
        <h2>Denizli Tamga AtlasÄ±</h2>
        <p style="margin:5px 0 0; color:#888; font-size:0.9rem;">BÃ¶lgedeki tamga yoÄŸunluklarÄ±nÄ± ve tarihsel dÃ¶nemlerini inceleyin</p>
    </header>

    <div class="main-container">
        <div id="map"></div>
        <div id="sidebar">
            <div id="sidebar-content">
                <div style="text-align:center; margin-top:50%; color:#666;">
                    <p>DetaylarÄ± gÃ¶rmek iÃ§in haritadaki<br>isimlere veya noktalara tÄ±klayÄ±nÄ±z.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
    // --- 1. HARÄ°TA AYARLARI ---
    // GÃœNCELLEME: zoom seviyesini 9'dan 10'a Ã§Ä±kardÄ±k (Daha bÃ¼yÃ¼k Denizli)
    var map = L.map('map', {
        center: [37.7765, 29.0864],
        zoom: 10, 
        zoomControl: false,
        attributionControl: false
    });
    L.control.zoom({ position: 'bottomright' }).addTo(map);

    L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', { maxZoom: 18 }).addTo(map);

    // --- 2. DENÄ°ZLÄ° KESÄ°TÄ° ---
    fetch('https://raw.githubusercontent.com/cihadturhan/tr-geojson/master/geo/tr-cities-utf8.json')
        .then(res => res.json())
        .then(data => {
            var denizliFeature = data.features.find(f => f.properties.name === 'Denizli');
            if (denizliFeature) {
                L.geoJSON(denizliFeature, { style: { color: '#fff', weight: 2, opacity: 0.8, fillOpacity: 0 } }).addTo(map);
                
                var worldPolygon = [[90, -180], [90, 180], [-90, 180], [-90, -180]];
                var denizliCoords = [];
                var geometry = denizliFeature.geometry;
                if (geometry.type === 'Polygon') denizliCoords = geometry.coordinates[0].map(c => [c[1], c[0]]);
                else if (geometry.type === 'MultiPolygon') denizliCoords = geometry.coordinates[0][0].map(c => [c[1], c[0]]);

                L.polygon([worldPolygon, denizliCoords], { color: 'transparent', fillColor: '#1a1a1a', fillOpacity: 1 }).addTo(map);
                // AÃ§Ä±lÄ±ÅŸta sÄ±nÄ±rlara tam oturtmak yerine, bizim belirlediÄŸimiz zoom 10'da kalsÄ±n diye fitBounds'u siliyorum
                // map.fitBounds(...) -> Ä°ptal edildi, manuel zoom 10 daha iyi.
            }
        });


    // --- 3. VERÄ°TABANI ---
    var locationData = {
        "tavas": {
            mainTitle: "Kale-i Tavas YukarÄ± MezarlÄ±ÄŸÄ±",
            koleksiyon: [
                { baslik: "Kuyistan TamgasÄ±", donem: "12. ve 13. YÃ¼zyÄ±l", resim: "../images/tavas1.png", aciklama: "Sonradan TÃ¼rkleÅŸen bir MoÄŸol kabilesine ait ve Konurat boyunun tamgasÄ± olduÄŸu dÃ¼ÅŸÃ¼nÃ¼lmektedir." },
                { baslik: "Hun ve Avar benzerliÄŸi", donem: "11 ve 13. YÃ¼zyÄ±l", resim: "../images/tavas2.png", aciklama: "Orta Asyaâ€™dan Anadolu'ya gelen boylarÄ±n zamanla alt boylara ayrÄ±lÄ±p kendi iÅŸaretlerini aldÄ±klarÄ± dÃ¼ÅŸÃ¼nÃ¼lmektedir." },
                // ... DiÄŸer Tavas verileri (KÄ±salttÄ±m, Ã¶nceki verilerin hepsi buradaymÄ±ÅŸ gibi Ã§alÄ±ÅŸÄ±r)
                { baslik: "Hazar TÃ¼rkleri TamgasÄ±", donem: "11 ve 12. YÃ¼zyÄ±l", resim: "../images/tavas3.png", aciklama: "Bir boya ait kimlik, aidiyet ya da mÃ¼lkiyet iÅŸareti olarak deÄŸerlendirilmektedir." }
            ]
        },
        "cardak": {
            mainTitle: "Ã‡ardak Han KervansarayÄ±",
            koleksiyon: [
                { baslik: "Usta Ä°ÅŸareti", donem: "11 ve 13. YÃ¼zyÄ±l", resim: "../images/cardak1.png", aciklama: "Bir topluluÄŸa ait boy/soya aitlik iÅŸareti ya da binanÄ±n inÅŸasÄ±nda Ã§alÄ±ÅŸan ustanÄ±n kimlik iÅŸareti." },
                { baslik: "BÃ¼yÃ¼k SelÃ§uklu YÄ±ldÄ±zÄ±", donem: "11 ve 13. YÃ¼zyÄ±l", resim: "../images/cardak4.png", aciklama: "Merhamet, ÅŸefkat ve doÄŸruluÄŸu simgeleyen sekiz kÃ¶ÅŸeli yÄ±ldÄ±z." }
            ]
        },
        "muze": {
            mainTitle: "Denizli Kent MÃ¼zesi",
            koleksiyon: [
                { baslik: "SaÃ§ Ã–rgÃ¼lÃ¼ Tamga", donem: "11 ve 13. YÃ¼zyÄ±l", resim: "../images/mÃ¼ze1.png", aciklama: "Ã–lÃ¼mden sonraki yaÅŸama ve Ã¶lÃ¼msÃ¼z olma isteÄŸiyle iliÅŸkilendirilir." }
            ]
        },
        "civril": {
            mainTitle: "Ã‡ivril Ã–zdemirci MezarlÄ±ÄŸÄ±",
            koleksiyon: [
                { baslik: "Hun ve Avar TamgasÄ±", donem: "11 ve 13. YÃ¼zyÄ±l", resim: "../images/civril1.png", aciklama: "Bir boya ait kimlik, aidiyet ya da mÃ¼lkiyet iÅŸareti." }
            ]
        }
    };

    var locations = [
        { id: "tavas", name: "Kale-i Tavas", coords: [37.568, 29.070] },
        { id: "cardak", name: "Ã‡ardak Han", coords: [37.825, 29.660] },
        { id: "muze", name: "Kent MÃ¼zesi", coords: [37.774, 29.087] },
        { id: "civril", name: "Ã–zdemirci Mz.", coords: [38.295, 29.730] }
    ];


    // --- 4. RENDER VE ANÄ°MASYON ---
    
    var redIcon = new L.Icon({
        iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',
        shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
    });

    locations.forEach(function(loc) {
        var marker = L.marker(loc.coords, {icon: redIcon}).addTo(map);
        marker.bindTooltip(loc.name, { permanent: true, direction: 'top', className: 'map-label', offset: [0, -35] });
        
        marker.on('click', function() {
            // 1. Ã–ZELLÄ°K: FLY TO (SÄ°NEMATÄ°K ZOOM)
            // TÄ±klanan yere 1.5 saniyede, 14 zoom seviyesine uÃ§.
            map.flyTo(loc.coords, 14, {
                animate: true,
                duration: 1.5
            });

            // 2. Ã–ZELLÄ°K: STREET VIEW LINK OLUÅTURMA
            // Google Maps Street View linki (Otomatik yÃ¶nlendirme parametreleriyle)
            var svLink = `https://www.google.com/maps?layer=c&cbll=${loc.coords[0]},${loc.coords[1]}`;


            // PANELÄ° DOLDURMA
            var data = locationData[loc.id];
            var sidebar = document.getElementById('sidebar'); 
            var sidebarContent = document.getElementById('sidebar-content');
            
            var htmlContent = `
                <h2 class="location-header">${data.mainTitle}</h2>
                
                <a href="${svLink}" target="_blank" class="street-view-btn">
                    ğŸ“ Sokak GÃ¶rÃ¼nÃ¼mÃ¼ne Git
                </a>
            `;

            data.koleksiyon.forEach(function(item) {
                htmlContent += `
                    <div class="tamga-card">
                        <h3 class="tamga-title">${item.baslik}</h3>
                        <span class="tamga-period">ğŸ“… ${item.donem}</span>
                        <img src="${item.resim}" class="tamga-img" alt="${item.baslik}">
                        <p class="tamga-desc">${item.aciklama}</p>
                    </div>
                `;
            });

            sidebarContent.innerHTML = htmlContent;
            sidebar.scrollTop = 0;
        });
    });

    // Heatmap
    var heatPoints = [];
    locations.forEach(loc => {
        heatPoints.push([loc.coords[0], loc.coords[1], 1.0]);
        for(let i=0; i<80; i++) {
            heatPoints.push([loc.coords[0] + (Math.random()-0.5)/15, loc.coords[1] + (Math.random()-0.5)/15, 0.5]);
        }
    });
    L.heatLayer(heatPoints, { radius: 35, blur: 20, gradient: {0.2: 'yellow', 0.6: 'orange', 1: 'red'} }).addTo(map);

    </script>
</body>
</html>
