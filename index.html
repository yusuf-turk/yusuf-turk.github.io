<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Denizli TamgalarÄ± - Ã–zel Kesit Harita</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        /* --- GENEL TASARIM (Koyu Tema) --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1a1a1a; /* Sayfa arka planÄ± */
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        header {
            background-color: #111;
            color: #eee;
            text-align: center;
            padding: 15px;
            flex-shrink: 0;
            border-bottom: 3px solid #c0392b;
            z-index: 1000;
        }

        .main-container {
            display: flex;
            flex: 1;
            height: 100%;
            position: relative;
        }

        #map {
            flex: 3;
            height: 100%;
            background-color: #1a1a1a; /* Harita yÃ¼klenirken zemin rengi (Body ile aynÄ± olmalÄ±) */
            z-index: 1;
        }

        #sidebar {
            flex: 1;
            background-color: #222;
            color: #ddd;
            padding: 25px;
            overflow-y: auto;
            border-left: 1px solid #333;
            box-shadow: -5px 0 15px rgba(0,0,0,0.5);
            z-index: 2;
        }

        /* --- HARÄ°TA ÃœZERÄ°NDEKÄ° Ä°SÄ°M ETÄ°KETLERÄ° --- */
        .map-label {
            background: transparent;
            border: none;
            box-shadow: none;
            color: #fff;
            font-weight: bold;
            font-size: 14px;
            text-shadow: 2px 2px 4px #000, -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
            margin-top: -10px; /* YazÄ±yÄ± biraz yukarÄ± al */
        }

        /* Sidebar Ä°Ã§erik Stilleri */
        .info-title { color: #e74c3c; border-bottom: 1px solid #444; padding-bottom: 10px; }
        .info-img { width: 100%; height: auto; border-radius: 6px; margin-bottom: 15px; border: 2px solid #444; }
        .info-text { line-height: 1.6; color: #ccc; }
        .coord-text { display: block; margin-top: 15px; font-size: 0.8rem; color: #888; text-align: right; }

        @media (max-width: 768px) {
            .main-container { flex-direction: column; }
            #map { flex: 1; height: 50vh; }
            #sidebar { flex: 1; height: 50vh; }
        }
    </style>
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>
</head>
<body>

    <header>
        <h2>Denizli Tamga AtlasÄ±</h2>
        <p style="margin:5px 0 0; color:#888; font-size:0.9rem;">BÃ¶lgedeki tamga yoÄŸunluklarÄ±nÄ± ve lokasyonlarÄ± gÃ¶steren interaktif harita</p>
    </header>

    <div class="main-container">
        <div id="map"></div>
        <div id="sidebar">
            <div id="sidebar-content">
                <div style="text-align:center; margin-top:50%; color:#666;">
                    <p>DetaylarÄ± gÃ¶rmek iÃ§in haritadaki<br>isimlere veya noktalara tÄ±klayÄ±nÄ±z.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
    // --- 1. HARÄ°TA KURULUMU ---
    var map = L.map('map', {
        center: [37.7765, 29.0864],
        zoom: 9,
        zoomControl: false,
        attributionControl: false // SaÄŸ alttaki yazÄ±larÄ± temizledim (Daha ÅŸÄ±k durmasÄ± iÃ§in)
    });

    L.control.zoom({ position: 'bottomright' }).addTo(map);

    // Uydu GÃ¶rÃ¼ntÃ¼sÃ¼
    L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
        maxZoom: 18
    }).addTo(map);


    // --- 2. DENÄ°ZLÄ° KESÄ°P Ã‡IKARMA (SOLID MASK) ---
    fetch('https://raw.githubusercontent.com/cihadturhan/tr-geojson/master/geo/tr-cities-utf8.json')
        .then(res => res.json())
        .then(data => {
            var denizliFeature = data.features.find(f => f.properties.name === 'Denizli');

            if (denizliFeature) {
                // A. SÄ±nÄ±r Ã‡izgisi (Ä°nce ve Zarif)
                L.geoJSON(denizliFeature, {
                    style: { color: '#fff', weight: 2, opacity: 0.8, fillOpacity: 0 }
                }).addTo(map);

                // B. KESME Ä°ÅLEMÄ° (DÄ±ÅŸarÄ±yÄ± KATI RENK ile kapatma)
                var worldPolygon = [[90, -180], [90, 180], [-90, 180], [-90, -180]];
                var denizliCoords = [];
                
                var geometry = denizliFeature.geometry;
                if (geometry.type === 'Polygon') {
                    denizliCoords = geometry.coordinates[0].map(c => [c[1], c[0]]);
                } else if (geometry.type === 'MultiPolygon') {
                    denizliCoords = geometry.coordinates[0][0].map(c => [c[1], c[0]]);
                }

                // Maske katmanÄ±: Rengi sayfa arka planÄ±yla (#1a1a1a) AYNI yapÄ±yoruz.
                // OpaklÄ±ÄŸÄ± 1 (Tam katÄ±) yapÄ±yoruz.
                // BÃ¶ylece Denizli harici her yer "yokmuÅŸ" gibi gÃ¶rÃ¼nÃ¼yor.
                L.polygon([worldPolygon, denizliCoords], {
                    color: 'transparent',
                    fillColor: '#1a1a1a', // Body background ile aynÄ± renk!
                    fillOpacity: 1        // %100 GÃ¶rÃ¼nÃ¼r (ArkayÄ± gÃ¶stermez)
                }).addTo(map);

                map.fitBounds(L.geoJSON(denizliFeature).getBounds());
            }
        });


    // --- 3. VERÄ°LER ---
    var locationData = {
        "tavas": {
            title: "Kale-i Tavas MezarlÄ±ÄŸÄ±",
            img: "https://via.placeholder.com/600x400.png/333/eee?text=Kale-i+Tavas",
            desc: "Kale-i Tavas, Denizli'nin gÃ¼neybatÄ±sÄ±nda yer alan tarihi bir yerleÅŸimdir. Burada bulunan mezar taÅŸlarÄ±nda OÄŸuz boylarÄ±na ait, Ã¶zellikle KayÄ± ve AvÅŸar boyu tamgalarÄ±na rastlanmÄ±ÅŸtÄ±r."
        },
        "cardak": {
            title: "Ã‡ardak Han KervansarayÄ±",
            img: "https://via.placeholder.com/600x400.png/333/eee?text=Cardak+Han",
            desc: "Ä°pek Yolu Ã¼zerinde bulunan Ã‡ardak Han, SelÃ§uklu dÃ¶nemi mimarisinin en gÃ¼zel Ã¶rneklerinden biridir. Han duvarlarÄ±nda taÅŸÃ§Ä± iÅŸaretleri olarak bilinen tamgalar mevcuttur."
        },
        "muze": {
            title: "Denizli Kent MÃ¼zesi",
            img: "https://via.placeholder.com/600x400.png/333/eee?text=Kent+Muzesi",
            desc: "Denizli Kent MÃ¼zesi'nde sergilenen etnografik eserler, bÃ¶lgedeki YÃ¶rÃ¼k kÃ¼ltÃ¼rÃ¼nÃ¼n izlerini taÅŸÄ±r. Dokumalarda oba tamgalarÄ± gÃ¶rÃ¼lebilir."
        },
        "civril": {
            title: "Ã‡ivril Ã–zdemirci MezarlÄ±ÄŸÄ±",
            img: "https://via.placeholder.com/600x400.png/333/eee?text=Ozdemirci",
            desc: "Ã‡ivril bÃ¶lgesi, TÃ¼rklerin Anadolu'ya giriÅŸinde Ã¶nemli bir geÃ§iÅŸ noktasÄ±dÄ±r. Ã–zdemirci mezarlÄ±ÄŸÄ±ndaki balbal taÅŸlarÄ± Ä°slamiyet Ã¶ncesi inancÄ±n izlerini taÅŸÄ±r."
        }
    };

    var locations = [
        { id: "tavas", name: "Kale-i Tavas", coords: [37.568, 29.070] },
        { id: "cardak", name: "Ã‡ardak Han", coords: [37.825, 29.660] },
        { id: "muze", name: "Kent MÃ¼zesi", coords: [37.774, 29.087] },
        { id: "civril", name: "Ã–zdemirci Mz.", coords: [38.295, 29.730] }
    ];


    // --- 4. MARKERLAR VE ETÄ°KETLER ---
    
    // KÄ±rmÄ±zÄ± Ä°kon AyarÄ±
    var redIcon = new L.Icon({
        iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',
        shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
        iconSize: [25, 41],
        iconAnchor: [12, 41],
        popupAnchor: [1, -34],
        shadowSize: [41, 41]
    });

    locations.forEach(function(loc) {
        var marker = L.marker(loc.coords, {icon: redIcon}).addTo(map);

        // Ä°SÄ°M ETÄ°KETÄ° EKLEME (KALICI)
        marker.bindTooltip(loc.name, {
            permanent: true,      // SÃ¼rekli aÃ§Ä±k kalsÄ±n
            direction: 'top',     // Ä°ÅŸaretÃ§inin Ã¼stÃ¼nde dursun
            className: 'map-label', // CSS stilini uygula
            offset: [0, -35]      // Konumu biraz yukarÄ± kaydÄ±r
        });
        
        // TÄ±klama Fonksiyonu
        marker.on('click', function() {
            var data = locationData[loc.id];
            var sidebar = document.getElementById('sidebar-content');
            sidebar.innerHTML = `
                <h2 class="info-title">${data.title}</h2>
                <img src="${data.img}" class="info-img" alt="${data.title}">
                <p class="info-text">${data.desc}</p>
                <span class="coord-text">ğŸ“ ${loc.coords[0].toFixed(4)}, ${loc.coords[1].toFixed(4)}</span>
            `;
        });
    });

    // --- 5. HEATMAP (SarÄ±-KÄ±rmÄ±zÄ± Uydu Uyumlu) ---
    var heatPoints = [];
    locations.forEach(loc => {
        heatPoints.push([loc.coords[0], loc.coords[1], 1.0]);
        for(let i=0; i<80; i++) { // Biraz daha yoÄŸunlaÅŸtÄ±rdÄ±m
            heatPoints.push([
                loc.coords[0] + (Math.random()-0.5)/15, 
                loc.coords[1] + (Math.random()-0.5)/15, 
                0.5
            ]);
        }
    });

    L.heatLayer(heatPoints, { 
        radius: 35,
        blur: 20, 
        gradient: {0.2: 'yellow', 0.6: 'orange', 1: 'red'} 
    }).addTo(map);

    </script>
</body>
</html>
